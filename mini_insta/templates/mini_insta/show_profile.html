<!--file: templates/mini_insta/show_proflie.html-->
<!--author: Ashtosh Bhandari ashtosh@bu.edu -->
<!--description: the page that extends the base and contains specific profile -->

{% extends 'mini_insta/base.html' %}
    {% block content %}
    
    <div class="profile-page">

        <div class="profile-header">
            <img class="profile-image-large" src="{{ profile.profile_image_url }}" alt="{{ profile.display_name }}'s profile picture">

            <div class="profile-header-info">
                <h1 class="profile-name">{{ profile.display_name }}</h1>
                <p class="profile-username">@{{ profile.username }}</p>

                <div class="profile-stats">
                    <a href="{% url 'show_followers' pk=profile.pk %}" class="stat-item">
                        <span class="stat-count">{{ profile.get_num_followers }}</span>
                        <span class="stat-label">Followers</span>
                    </a>
                    <a href="{% url 'show_following' pk=profile.pk %}" class="stat-item">
                        <span class="stat-count">{{ profile.get_num_following }}</span>
                        <span class="stat-label">Following</span>
                    </a>
                </div>
            </div>
        </div>


        <div class="profile-bio">
            <p>{{ profile.bio_text }}</p>
        </div>

        <!-- Update profile button - only show if this is the user's own profile -->
        {% if user.is_authenticated and profile.user == user %}
        <a class="profile-update-button" href="{% url 'update_profile' %}">
            Update Profile
        </a>
        {% endif %}

        <!-- Follow/Unfollow button - only show if viewing another user's profile -->
        {% if user.is_authenticated and profile.user != user %}
            {% if is_following %}
                <a class="follow-button following" href="{% url 'delete_follow' pk=profile.pk %}">
                    Unfollow
                </a>
            {% else %}
                <a class="follow-button" href="{% url 'follow' pk=profile.pk %}">
                    Follow
                </a>
            {% endif %}
        {% endif %}



        <div class="profile-posts">
            
            <h2>Posts</h2>

            <div class="profile-posts-grid">
            
                {% for post in profile.get_all_posts %}
            
                    <a href="{% url 'post_detail' post.pk %}" class="post">
                
                        {% if post.get_all_photos.first %}
                        <img src="{{ post.get_all_photos.first.get_image_url }}" alt="Post thumbnail">

                        {% else %}
                            <img src="https://www.nomadfoods.com/wp-content/uploads/2018/08/placeholder-1-e1533569576673.png" alt="No Image">
                            
                        {% endif %}

                    </a>

                {% empty %}
                    <p>No posts yet.</p>

                {% endfor %}
            </div>
        </div>


    </div>




{% endblock%}

 